<!-- @let elapsedTime = (engineService.elapsedTime$|async ) ?? 0; -->

<router-outlet></router-outlet>

<scene>
  <directionalLight [position]="[44, 44, 44]" [intensity]="2" />
  <ambientLight [intensity]="0.5" />
  <pointLight />

  <orbitControls></orbitControls>

  <gridHelper />

  <mesh>
    <sphereGeometry [params]="{ radius: 1 }" />
    <meshStandardMaterial [params]="{ color: 'red' }" />
  </mesh>

  <skinnedMesh [debug]="true"> </skinnedMesh>

  <physics>
    <!--Flat Plane-->
    @let size = 1000;
    <rigidBody [rigidBodyType]="RigidBodyType.Fixed" [position]="[0, -1, 0]">
      <cuboidCollider
        [halfExtents]="[size / 2, 1, size / 2]"
        [friction]="0.9"
      ></cuboidCollider>
      <mesh [rotation]="[x, y, 0]" [receiveShadow]="true">
        <planeGeometry [params]="[size, size, 1, 10]"></planeGeometry>
        <meshStandardMaterial
          [params]="{ color: 'springgreen' }"
        ></meshStandardMaterial>
      </mesh>
    </rigidBody>

    @for (i of [1, 2, 3, 4, 5]; track i) {
      <rigidBody [rigidBodyType]="RigidBodyType.Dynamic" [position]="[0, i, i]">
        <mesh [castShadow]="true" [receiveShadow]="true">
          <boxGeometry [params]="[1]" />
          <meshStandardMaterial [params]="{ color: 'blue' }" />
        </mesh>
        <cuboidCollider [halfExtents]="[1, 1, 1]" />
      </rigidBody>
    }
  </physics>

  <!-- <sky-sphere [dayNightCycle]="(elapsedTime / 10 % 1) "/> -->

  <!-- <sky
    [scale]="2000"
    [turbidity]="10"
    [rayleigh]="3"
    [mieCoefficient]="0.005"
    [mieDirectionalG]="0.7"
    [elevation]="(elapsedTime / 10 % 1) * 180"
     
    [exposure]="0.5">
</sky>

  -->
  <skyBox />
  <ocean />
</scene>
